class Timer{constructor(){this.timerInterval=null,this.timeLeft=180,this.timerContainer=document.querySelector(".sticky-container1"),this.timerCount=document.getElementById("timer-count"),this.timer1=document.getElementById("timer1"),this.timerDone=document.getElementById("timer-done")}init(){this.timerContainer.classList.add("timer-hidden"),this.timerContainer.style.display="none"}show(){this.timerContainer.style.display="block","function"==typeof animateTimerIn&&animateTimerIn()}start(e){this.timerInterval=setInterval(()=>this.updateDisplay(e),1e3),this.updateDisplay(e)}updateDisplay(e){let t=Math.floor(this.timeLeft/60),s=this.timeLeft%60;this.timerCount.textContent=`${String(t).padStart(2,"0")} MINUTES AND ${String(s).padStart(2,"0")} SECONDS`,this.timeLeft<=0&&(this.stop(),this.timer1.classList.add("d-none"),this.timerDone.classList.remove("d-none"),e&&"function"==typeof e&&e()),this.timeLeft--}stop(){clearInterval(this.timerInterval)}reset(){this.stop(),this.timeLeft=180;let e=this.timerContainer.offsetHeight||0;this.timerContainer.style.display="none",this.timerContainer.classList.add("timer-hidden"),e>0&&anime({targets:"header, .sections-wrapper",translateY:0,duration:300,easing:"easeOutQuad"}),this.timer1.classList.remove("d-none"),this.timerDone.classList.add("d-none")}}class Quiz{constructor(){this.quizData=[{question:"Are you based in the US?",description:"We are looking for participants from US and CA only.",answer:["Yes","No"],correctAnswerIndex:0},{question:"How often do you shop at Aldi?",answer:["Daily","Weekly","Monthly","Never"],correctAnswerIndex:1},{question:"How do you usually discover deals and promotions at Aldi?",answer:["Store flyers","Social media","Mobile app","Friends/Family",],correctAnswerIndex:2},],this.currentQuestionIndex=0,this.isValid=!0,this.quizContainer=document.getElementById("quiz-models"),this.questionCounterNumber=document.getElementById("question-counter-number"),this.animationInProgress=!1}loadQuestion(e){if(!this.quizContainer){console.error("Quiz container element not found.");return}if(this.currentQuestionIndex<this.quizData.length){let t=this.quizData[this.currentQuestionIndex],s=`
        <div class="quiz-question" style="opacity: 0; transform: translateY(20px);">${t.question}</div>
        <div class="quiz-answers">
          ${t.answer.map((e,t)=>`
                <div class="quiz-answer" data-answer-index="${t}" style="opacity: 0; transform: translateY(20px);">
                    ${e}
                </div>
              `).join("")}
        </div>
      `;if(this.quizContainer.children.length>0&&!this.animationInProgress){this.animationInProgress=!0;let a=document.createElement("div");a.classList.add("quiz-next-container"),a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.opacity="0",a.style.pointerEvents="none",a.innerHTML=s,this.quizContainer.parentNode.insertBefore(a,this.quizContainer.nextSibling);let i=anime.timeline({easing:"easeOutQuad",complete:()=>{this.quizContainer.innerHTML=s,a.remove(),this.animateQuestionContent(),this.attachAnswerListeners(e),this.animationInProgress=!1}});i.add({targets:this.quizContainer.querySelectorAll(".quiz-question, .quiz-answer"),opacity:[1,0],translateX:[0,-30],duration:400,easing:"easeOutQuad",delay:anime.stagger(50)}),this.updateQuestionCounter()}else this.quizContainer.innerHTML=s,this.updateQuestionCounter(),this.animateQuestionContent(),this.attachAnswerListeners(e)}else e&&"function"==typeof e&&e("completed",this.isValid)}animateQuestionContent(){anime({targets:this.quizContainer.querySelector(".quiz-question"),opacity:[0,1],translateY:[20,0],duration:500,easing:"easeOutQuad"}),anime({targets:this.quizContainer.querySelectorAll(".quiz-answer"),opacity:[0,1],translateY:[20,0],duration:500,delay:anime.stagger(100,{start:200}),easing:"easeOutQuad"})}updateQuestionCounter(){anime({targets:this.questionCounterNumber,opacity:[1,0],translateY:[0,-10],duration:200,easing:"easeOutQuad",complete:()=>{this.questionCounterNumber.textContent=this.currentQuestionIndex+1,anime({targets:this.questionCounterNumber,opacity:[0,1],translateY:[10,0],duration:300,easing:"easeOutQuad"})}})}attachAnswerListeners(e){document.querySelectorAll(".quiz-answer").forEach(t=>{t.addEventListener("click",t=>{anime({targets:t.target,scale:[1,1.05,1],backgroundColor:["rgba(37, 99, 235, 0.1)","rgba(37, 99, 235, 0.2)","rgba(37, 99, 235, 0.1)",],duration:400,easing:"easeOutQuad",complete:()=>{this.handleAnswerClick(t,e)}})})})}handleAnswerClick(e,t){if(this.animationInProgress)return;let s=parseInt(e.target.dataset.answerIndex);if(isNaN(s)){console.error("Invalid answer index.");return}0===this.currentQuestionIndex&&(this.isValid=0===s),this.isValid?(this.currentQuestionIndex++,this.loadQuestion(t)):t&&"function"==typeof t&&t("invalid",this.isValid)}reset(){this.currentQuestionIndex=0,this.isValid=!0,this.quizContainer&&(this.quizContainer.innerHTML="")}}class LoadingHandler{constructor(){this.loadingIds=["loading11","loading21","loading31","loading41"]}async addCheckMarks(e){try{let t=anime.timeline({easing:"easeOutQuad",complete(){e&&"function"==typeof e&&anime({targets:".loading-container",scale:[1,.95],opacity:[1,0],translateY:[0,-10],duration:500,easing:"easeOutQuad",complete(){e()}})}});this.loadingIds.forEach((e,t)=>{let s=document.getElementById(e);s&&(s.style.opacity="0",s.style.transform="translateX(-20px)")}),this.loadingIds.forEach((e,s)=>{t.add({targets:`#${e}`,opacity:[0,1],translateX:[-20,0],duration:400,delay:200*s,easing:"easeOutQuad"}),t.add({duration:800,complete:()=>{this.showCheckIcon(e)}}),s<this.loadingIds.length-1&&t.add({duration:200})})}catch(s){console.error("Error in addCheckMarks:",s)}}showCheckIcon(e){let t=document.getElementById(e);if(t){let s=document.createElement("i");s.className="material-icons",s.textContent="check_circle",s.style.opacity="0",s.style.transform="scale(0.5)",t.appendChild(s),anime({targets:s,opacity:[0,1],scale:[.5,1.2,1],duration:600,easing:"easeOutElastic(1, 0.5)"}),anime({targets:t,color:["#000","#2563eb","#000"],duration:1e3,easing:"easeOutQuad"})}else console.error(`Element with ID "${e}" not found.`)}}class CommentsSystem{constructor(){this.visible=5,this.currentlyVisible=5,this.text_remaining=0,this.comments=[{order:1,likes:1,avatar:"./assets/images/1.jpg",profile:"#",name:"Elizabeth Amber",text:"I just received my Aldi gift card, and I'm thrilled! Thank you, Shop Smart Program!",image:"./assets/images/test7.jpg",age:"a week ago",createdAt:new Date(2023,11,28),comments:[]},{order:2,likes:1,avatar:"./assets/images/2.jpg",profile:"#",name:"Linda Bailey",text:"Disappointed that I didn't get it, but happy for those who did. I'll try again next time",image:null,age:"a week ago",createdAt:new Date(2023,11,27),comments:[]},{order:3,likes:3,avatar:"./assets/images/3.jpg",profile:"#",name:"Susan Barbara",text:"It just arrived, already did some shopping. Thanks a ton guys!",image:"./assets/images/test1.jpg",age:"a week ago",createdAt:new Date(2023,11,26),comments:[{likes:16,avatar:"./assets/images/brand.jpg",profile:"#",name:"Shop Smart Program",text:"We hope you find everything you need, Barbara! Enjoy!",age:"a week ago",createdAt:new Date(2023,11,26,2,30)},{likes:3,avatar:"./assets/images/3.jpg",profile:"#",name:"Susan Barbara",text:"I'm sure I will!",age:"a week ago",createdAt:new Date(2023,11,26,4,15)},]},{order:4,likes:7,avatar:"./assets/images/4.jpg",profile:"#",name:"Richard Richards",text:"I think it will be enough for my girlfriend for the whole month's shopping",image:null,age:"two weeks ago",createdAt:new Date(2023,11,20),comments:[]},{order:5,likes:7,avatar:"./assets/images/5.jpg",profile:"#",name:"Laura Hernandez",text:"I didn't spend even half of the amount, but I managed to get a lot. I think they won a customer",image:null,age:"two weeks ago",createdAt:new Date(2023,11,19),comments:[{likes:25,avatar:"./assets/images/brand.jpg",profile:"#",name:"Shop Smart Program",text:"Enjoy your grocery shopping! We're happy for you!",age:"two weeks ago",createdAt:new Date(2023,11,19,3,45)},]},{order:6,likes:8,avatar:"./assets/images/10.jpg",profile:"#",name:"Paul Harris",text:"No luck for me, but at least I tried",image:null,age:"two weeks ago",createdAt:new Date(2023,11,18),comments:[]},{order:7,likes:3,avatar:"./assets/images/11.jpg",profile:"#",name:"Sarah Trajbar",text:"I had no more space for them in the trunk, so I put them wherever I could. Thanks to the whole Shop Smart Program team:",image:"./assets/images/test2.jpg",age:"two weeks ago",createdAt:new Date(2023,11,17),comments:[{likes:56,avatar:"./assets/images/brand.jpg",profile:"#",name:"Shop Smart Program",text:"That's what we like to hear, happy shopping!",age:"two weeks ago",createdAt:new Date(2023,11,17,5,20)},]},{order:8,likes:12,avatar:"./assets/images/12.jpg",profile:"#",name:"Gary Currier",text:"When I get home I will invite my friends to a barbecue",image:"./assets/images/test5.jpg",age:"two weeks ago",createdAt:new Date(2023,11,16),comments:[]},{order:9,likes:3,avatar:"./assets/images/13.jpg",profile:"#",name:"Eric Feller",text:"What?? I just got accepted. Can't believe it!",image:null,age:"two weeks ago",createdAt:new Date(2023,11,15),comments:[]},{order:10,likes:1,avatar:"./assets/images/14.jpg",profile:"#",name:"Moore Pamela",text:"What a pleasant surprise! It really is a help, food has become very expensive",image:null,age:"two weeks ago",createdAt:new Date(2023,11,14),comments:[]},{order:11,likes:1,avatar:"./assets/images/15.jpg",profile:"#",name:"Ari Marie",text:"I haven't had the car so loaded for a long time. Thank you very much:",image:null,age:"two weeks ago",createdAt:new Date(2023,11,13),comments:[]},{order:13,likes:6,avatar:"./assets/images/20.jpg",profile:"#",name:"Justin Mcmullan",text:"Tonight I will cook. I'm curious what my family will say, it doesn't happen very often. Hope that there will be future editions of this Program, I'll definitely participate",image:"./assets/images/test4.jpg",age:"two weeks ago",createdAt:new Date(2023,11,12),comments:[]},]}init(){this.setupJQueryExtensions(),this.renderCommentsToDOM(),this.setupEventListeners()}getTotalCommentCount(){let e=this.comments.length;for(let t of this.comments)e+=t.comments.length;return e}setupJQueryExtensions(){}renderComments(){let e=`
      <div class="comment sort-coms start-coms" data-order="{{ORDER}}" data-likes="{{LIKES}}" data-created-at="{{CREATED_TIMESTAMP}}">
        <div class="comment-header">
          <div class="comment-user-img">
            <img src="{{AVATAR}}" width="48" height="48" alt="{{USERNAME}}" />
          </div>
          <div class="comment-user-info">
            <div class="comment-user-name">{{USERNAME}}</div>
            <div class="comment-time">{{TIMEAGO}}</div>
          </div>
        </div>
        <div class="comment-text">{{COMMENT_TEXT}} {{COMMENT_IMG}}</div>
        <div class="comment-actions">
          <button class="comment-action like-button" title="Like">
            <i class="material-icons">thumb_up</i>
            <span class="like-count">{{LIKES}}</span>
          </button>
          <button class="comment-action" title="Reply">
            <i class="material-icons">reply</i>
          </button>
        </div>
        {{SUB_COMMENTS}}
      </div>
    `,t=`
      <div class="comment">
        <div class="comment-header">
          <div class="comment-user-img">
            <img src="{{AVATAR}}" width="48" height="48" alt="{{USERNAME}}" />
          </div>
          <div class="comment-user-info">
            <div class="comment-user-name">{{USERNAME}}</div>
            <div class="comment-time">{{TIMEAGO}}</div>
          </div>
        </div>
        <div class="comment-text">{{COMMENT_TEXT}}</div>
        <div class="comment-actions">
          <button class="comment-action like-button" title="Like">
            <i class="material-icons">thumb_up</i>
            <span class="like-count">{{LIKES}}</span>
          </button>
          <button class="comment-action" title="Reply">
            <i class="material-icons">reply</i>
          </button>
        </div>
      </div>
    `,s="";for(let a of this.comments){a.createdAt||(a.createdAt=new Date);let i="";for(let n of a.comments)n.createdAt||(n.createdAt=new Date),i+=t.replace(RegExp("{{PROFILE_URL}}","g"),n.profile).replace(/{{AVATAR}}/g,n.avatar).replace(/{{USERNAME}}/g,n.name).replace(RegExp("{{COMMENT_TEXT}}","g"),n.text).replace(/{{LIKES}}/g,n.likes).replace(/{{TIMEAGO}}/g,n.age);let o=a.image?`<div class="comment-image"><img class="fb-img" src="${a.image}" alt="${a.name}"/></div>`:"",r=a.createdAt.getTime();s+=e.replace(RegExp("{{PROFILE_URL}}","g"),a.profile).replace(/{{AVATAR}}/g,a.avatar).replace(/{{USERNAME}}/g,a.name).replace(RegExp("{{COMMENT_TEXT}}","g"),a.text).replace(RegExp("{{COMMENT_IMG}}","g"),o).replace(/{{LIKES}}/g,a.likes).replace(/{{ORDER}}/g,a.order).replace(RegExp("{{CREATED_TIMESTAMP}}","g"),r).replace(/{{TIMEAGO}}/g,a.age).replace(RegExp("{{SUB_COMMENTS}}","g"),i)}return s}renderCommentsToDOM(){let e=this.renderComments();$(".main-comments").html(e),setTimeout(()=>{let e=this.getTotalCommentCount();$(".sorting-box > p").html(`${e} comments`),$(".start-coms").removeClass("start-coms"),this.setupInitialCommentsView()},250)}setupInitialCommentsView(){$(".sort-coms").hide();let e=$(".main-comments > .sort-coms"),t=Math.min(this.currentlyVisible,e.length);e.slice(0,t).show();let s=$(".load-more");if(e.length<=t)s.hide();else{s.show();let a=e.length-t;s.find("span").text(`Load ${Math.min(5,a)} more comments`)}}setupEventListeners(){let e=this;$(document).on("click","textarea",function(){$(".add-comment").addClass("active")}),$(".comment-button-left [type=checkbox]").on("change",function(){$(this).is(":checked")&&e.text_remaining>0?($(".comment-button-left p").show(),$(".comment-button-right button").addClass("disabled").prop("disabled",!0)):($(".comment-button-left p").hide(),$(".comment-button-right button").removeClass("disabled").prop("disabled",!1))}),$(document).on("change","#sort-comments",function(){let t=$(this).val();"most-liked"===t?e.comments.sort((e,t)=>t.likes-e.likes):"newest"===t?e.comments.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()):"oldest"===t?e.comments.sort((e,t)=>e.createdAt.getTime()-t.createdAt.getTime()):e.comments.sort((e,t)=>e.order-t.order),e.currentlyVisible=e.visible;let s=e.renderComments();$(".main-comments").html(s),$(".inner-sorting-box > svg").css({display:"inline-block"}),setTimeout(function(){$(".inner-sorting-box > svg").hide()},200),e.setupInitialCommentsView()}),$(document).on("click",".load-more",function(){let t=$(".main-comments > .sort-coms:hidden"),s=t.slice(0,5);if(s.show(),e.currentlyVisible+=s.length,t.length<=5)$(this).addClass("end-coms").prop("disabled",!0).find("span").text("No More Comments");else{let a=t.length-5;$(this).find("span").text(`Load ${Math.min(5,a)} more comments`)}}),$("textarea").keyup(function(){let t=$(this).val().length;e.text_remaining=6-t,t<=0?$(".comment-button-right button").addClass("disabled").prop("disabled",!0):$(".comment-button-right button").removeClass("disabled").prop("disabled",!1),$(".comment-button-left p").html("Write "+e.text_remaining+" more characters to post to Facebook"),$(".comment-button-left [type=checkbox]").is(":checked")&&(e.text_remaining<=0?($(".comment-button-left p").hide(),$(".comment-button-right button").removeClass("disabled").prop("disabled",!1)):($(".comment-button-left p").show(),$(".comment-button-right button").addClass("disabled").prop("disabled",!0)))}),$(".comment-button-right button").on("click",function(){alert("Comments are disabled by the author.")}),$(".comment-meta button").on("click",function(){alert("Action prohibited. You are not authenticated.")}),$(document).on("click",".comment-action",function(){alert("Action prohibited. You are not authenticated.")})}}class ModalsManager{constructor(){this.faqTrigger=document.getElementById("faq-trigger"),this.faqModal=document.getElementById("faqModal"),this.closeModal=document.getElementById("closeModal"),this.faqItems=document.querySelectorAll(".faq-item")}init(){this.faqTrigger&&this.faqModal&&this.closeModal&&(this.setupEventListeners(),this.setupFaqItemsToggle())}setupEventListeners(){this.faqTrigger.addEventListener("click",()=>{this.faqModal.classList.add("show"),document.body.style.overflow="hidden"}),this.closeModal.addEventListener("click",()=>{this.faqModal.classList.remove("show"),document.body.style.overflow=""}),this.faqModal.addEventListener("click",e=>{e.target===this.faqModal&&(this.faqModal.classList.remove("show"),document.body.style.overflow="")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.faqModal.classList.contains("show")&&(this.faqModal.classList.remove("show"),document.body.style.overflow="")})}setupFaqItemsToggle(){let e=document.querySelectorAll(".faq-question");e.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("active");let t=e.nextElementSibling;t.classList.contains("show")?t.classList.remove("show"):(document.querySelectorAll(".faq-answer").forEach(e=>{e.classList.remove("show")}),t.classList.add("show"))})})}toggleFaq(e){let t=document.getElementById(`faq${e}`);if(t){let s=t.querySelector(".faq-answer"),a=t.querySelector(".faq-question");s&&a&&(a.classList.toggle("active"),s.classList.toggle("show"))}}}class SectionManager{constructor(){for(let e in this.sections={beforeQuiz:document.getElementById("before-quiz"),startQuiz:document.getElementById("start-quiz"),unaccepted:document.getElementById("unaccepted"),afterQuiz:document.getElementById("after-quiz"),finalPage:document.getElementById("final-page")},this.currentSection=null,this.animationInProgress=!1,this.sections)this.sections[e]||console.error(`Section "${e}" not found.`)}showSection(e){if(!this.sections[e]){console.error(`Section "${e}" not found.`);return}if(this.currentSection===e||this.animationInProgress)return;this.animationInProgress=!0;let t=this.currentSection?this.sections[this.currentSection]:null,s=this.sections[e],a=anime.timeline({easing:"easeOutQuad",complete:()=>{this.animationInProgress=!1}});return t&&a.add({targets:t,opacity:[1,0],translateY:[0,-20],scale:[1,.98],duration:300,easing:"easeOutQuad",complete(){t.classList.add("d-none")}}),a.add({targets:s,opacity:[0,1],translateY:[20,0],scale:[.98,1],duration:500,easing:"easeOutQuad",begin(){s.classList.remove("d-none"),s.style.opacity="0",s.style.visibility="visible"}},t?"+=50":0),this.currentSection=e,document.getElementById("page-content").scrollIntoView({behavior:"smooth"}),a}init(){this.sections.beforeQuiz&&(this.sections.beforeQuiz.classList.remove("d-none"),this.currentSection="beforeQuiz",anime({targets:this.sections.beforeQuiz,opacity:[0,1],translateY:[20,0],duration:600,easing:"easeOutQuad"}))}}document.addEventListener("DOMContentLoaded",()=>{try{let e=new Timer,t=new Quiz,s=new LoadingHandler,a=new CommentsSystem,i=new ModalsManager,n=new SectionManager;e.init(),n.init(),a.init(),i.init();let o=document.getElementById("start-quiz-button");o&&o.addEventListener("click",()=>{n.showSection("startQuiz"),e.show(),e.start(()=>{n.showSection("unaccepted")}),t.loadQuestion((t,a)=>{"invalid"===t?(e.stop(),n.showSection("unaccepted")):"completed"===t&&(n.showSection("afterQuiz"),s.addCheckMarks(()=>{n.showSection("finalPage")}))})});let r=document.getElementById("start-again");r&&r.addEventListener("click",()=>{n.showSection("beforeQuiz"),t.reset(),e.reset()})}catch(l){}});